(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/Index/Index"],{"016e":function(t,e,a){"use strict";a.r(e);var n=a("2eeb"),i=a("6a86");for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("e568");var s,r=a("f0c5"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=c.exports},"2eeb":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var n={heartbeat:function(){return a.e("components/heartbeat/heartbeat").then(a.bind(null,"75de"))}},i=function(){var t=this,e=t.$createElement,n=(t._self._c,t.bcgImgAreaShow||t.setting.hiddenIndex?null:t.__map(t.cityDatas.lifestyle,(function(e,n){var i=t.__get_orig(e),o=a("04c2")("./lifestyle_"+e.type+".png");return{$orig:i,m0:o}})));t.$mp.data=Object.assign({},{$root:{l0:n}})},o=[]},"6a65":function(t,e,a){"use strict";(function(t){a("7fb4");n(a("66fd"));var e=n(a("016e"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"6a86":function(t,e,a){"use strict";a.r(e);var n=a("9b35"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},8673:function(t,e,a){},"9b35":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a("c272");function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){s(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var r=function(){a.e("components/heartbeat/heartbeat").then(function(){return resolve(a("75de"))}.bind(null,a)).catch(a.oe)},c=getApp().globalData.key,u={components:{heartbeat:r},data:function(){return{cmpVersion:n.cmpVersion,isEmptyObject:n.isEmptyObject,formatDate:n.formatDate,isIPhoneX:getApp().globalData.isIPhoneX,message:"",cityDatas:{},hourlyDatas:[],weatherIconUrl:getApp().globalData.weatherIconUrl,detailsDic:{key:["cond_txt","tmp","fl","hum","pcpn","wind_dir","wind_deg","wind_sc","wind_spd","vis","pres","cloud"],val:{cond_txt:"天气",tmp:"温度(℃)",fl:"体感温度(℃)",hum:"相对湿度(%)",pcpn:"降水量(mm)",wind_dir:"风向",wind_deg:"风向角度(deg)",wind_sc:"风力(级)",wind_spd:"风速(mk/h)",vis:"能见度(km)",pres:"气压(mb)",cloud:"云量(%)"}},lifestyles:{comf:"舒适度指数",cw:"洗车指数",drsg:"穿衣指数",flu:"感冒指数",sport:"运动指数",trav:"旅游指数",uv:"紫外线指数",air:"空气污染扩散条件指数",ac:"空调开启指数",ag:"过敏指数",gl:"太阳镜指数",mu:"化妆指数",airc:"晾晒指数",ptfc:"交通指数",fsh:"钓鱼指数",spi:"防晒指数"},searchText:"",hasPopped:!1,animationMain:{},animationOne:{},animationTwo:{},animationThree:{},animationFour:{},located:!0,searchCity:"",setting:{},bcgImgList:[{src:"../../static/images/beach-bird-birds-235787.jpg",topColor:"#393836"},{src:"../../static/images/clouds-forest-idyllic-417102.jpg",topColor:"#0085e5"},{src:"../../static/images/backlit-dawn-dusk-327466.jpg",topColor:"#2d2225"},{src:"../../static/images/accomplishment-adventure-clear-sky-585825.jpg",topColor:"#004a89"},{src:"../../static/images/fog-himalayas-landscape-38326.jpg",topColor:"#b8bab9"},{src:"../../static/images/asphalt-blue-sky-clouds-490411.jpg",topColor:"#009ffe"},{src:"../../static/images/aerial-climate-cold-296559.jpg",topColor:"#d6d1e6"},{src:"../../static/images/beautiful-cold-dawn-547115.jpg",topColor:"#ffa5bc"}],bcgImgIndex:0,bcgImg:"",bcgImgAreaShow:!1,bcgColor:"#2d2225",showHeartbeat:!0,enableSearch:!0,openSettingButtonShow:!1,shareInfo:{}}},onLoad:function(){(0,n.isEmptyObject)(this.shareInfo)&&this.reloadPage()},methods:{reloadPage:function(){this.setBcgImg(),this.getCityDatas(),this.reloadInitSetting(),this.reloadWeather(),this.reloadGetBroadcast()},success:function(e,a){this.openSettingButtonShow=!1,this.searchCity=a,t.stopPullDownRefresh();var i=new Date;e.updateTime=i.getTime(),e.updateTimeFormat=(0,n.formatDate)(i,"MM-dd hh:mm");var s=["周日","周一","周二","周三","周四","周五","周六"],r=["今天","明天","后天"];e.daily_forecast=e.daily_forecast.map((function(t,e){var a=new Date(t.date).getDay();return o(o({},t),{},{day:0==e||1==e||2==e?r[e]:s[a]})})),t.setStorage({key:"cityDatas",data:e}),this.cityDatas=e},fail:function(e){var a=this;t.stopPullDownRefresh();var n=e.errMsg||"";-1!==n.indexOf("deny")||-1!==n.indexOf("denied")?t.showToast({title:"需要开启地理位置权限",icon:"none",duration:2500,success:function(e){if(a.canUseOpenSettingApi())var n=setTimeout((function(){clearTimeout(n),t.openSetting({})}),2500);else a.setData({openSettingButtonShow:!0})}}):t.showToast({title:"网络不给力，请稍后再试",icon:"none"})},commitSearch:function(t){this.search(this.searchText)},dance:function(){var t=this;this.enableSearch=!1;var e=this.$refs.heartbeat;e.dance((function(){t.showHeartbeat=!1,t.enableSearch=!0;var e=setTimeout((function(){t.showHeartbeat=!0,clearTimeout(e)}),500)}))},clearInput:function(){this.searchText=""},search:function(e,a){if("520"===e||"521"===e)return this.clearInput(),void this.dance();t.pageScrollTo({scrollTop:0,duration:300}),e&&(this.located=!1,this.getWeather(e),this.getHourly(e)),a&&a()},canUseOpenSettingApi:function(){var t=getApp().globalData.systeminfo,e=t.SDKVersion,a=(0,n.cmpVersion)(e,"2.0.7");return a<0},init:function(e,a){var n=this;this.located=!0,t.getLocation({type:"wgs84",success:function(t){n.getWeather("".concat(t.latitude,",").concat(t.longitude)),n.getHourly("".concat(t.latitude,",").concat(t.longitude)),a&&a()},fail:function(t){n.fail(t)}})},getWeather:function(e){var a=this;t.request({url:"".concat(getApp().globalData.requestUrl.weather),data:{location:e,key:c},success:function(n){if(200===n.statusCode){var i=n.data.HeWeather6[0];"ok"===i.status?(a.clearInput(),a.success(i,e)):t.showToast({title:"查询失败",icon:"none"})}},fail:function(){t.showToast({title:"查询失败",icon:"none"})}})},getHourly:function(e){var a=this;t.request({url:"".concat(getApp().globalData.requestUrl.hourly),data:{location:e,key:c},success:function(t){if(200===t.statusCode){var e=t.data.HeWeather6[0];"ok"===e.status&&(a.hourlyDatas=e.hourly||[])}},fail:function(){t.showToast({title:"查询失败",icon:"none"})}})},onPullDownRefresh:function(t){this.reloadPage()},getCityDatas:function(){var e=this;t.getStorage({key:"cityDatas",success:function(t){e.cityDatas=t.data}})},setBcgImg:function(e){var a=this;if(void 0!==e)return this.bcgImgIndex=e,this.bcgImg=this.bcgImgList[e].src,this.bcgColor=this.bcgImgList[e].topColor,void this.setNavigationBarColor();t.getStorage({key:"bcgImgIndex",success:function(t){var e=t.data||0,n=a.bcgImgList.length;a.bcgImgIndex=e,a.bcgImg=e>n-1?a.bcgImgList[0].src:a.bcgImgList[e].src,a.bcgColor=e>n-1?a.bcgImgList[0].topColor:a.bcgImgList[e].topColor,a.setNavigationBarColor()},fail:function(){a.bcgImgIndex=0,a.bcgImg=a.bcgImgList[0].src,a.bcgColor=a.bcgImgList[0].topColor,a.setNavigationBarColor()}})},setNavigationBarColor:function(e){e||this.bcgColor;t.setNavigationBarColor({frontColor:"#ffffff",backgroundColor:this.bcgColor})},getBroadcast:function(t){},reloadGetBroadcast:function(){var t=this;this.getBroadcast((function(e){t.message=e}))},reloadWeather:function(){this.located?this.init({}):(this.search(this.searchCity),this.searchCity="")},checkUpdate:function(e){if(e.forceUpdate&&t.getUpdateManager){var a=t.getUpdateManager();a.onCheckForUpdate((function(t){console.error(t)})),a.onUpdateReady((function(){t.showModal({title:"更新提示",content:"新版本已下载完成，是否重启应用？",success:function(t){t.confirm&&a.applyUpdate()}})}))}},showBcgImgArea:function(){t.setNavigationBarTitle({title:"更换背景"}),this.bcgImgAreaShow=!0},hideBcgImgArea:function(){t.setNavigationBarTitle({title:"查询天气"}),this.bcgImgAreaShow=!1},chooseBcg:function(e,a){e.src;this.setBcgImg(a),t.setStorage({key:"bcgImgIndex",data:a})},uploadBcg:function(){var e=this;t.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(a){var n=e.bcgImgList;n.push({src:a.tempFilePaths[0],topColor:"#000",showCloseBtn:!0}),e.bcgImgList=n;var i=e.bcgImgList.length-1;e.setBcgImg(i),t.setStorage({key:"bcgImgIndex",data:i})}})},removeUploadBcg:function(){var e=this.bcgImgList;e.pop(),this.bcgImgList=e;var a=this.bcgImgList.length-1;this.setBcgImg(a),t.setStorage({key:"bcgImgIndex",data:a})},toCitychoose:function(){t.navigateTo({url:"/pages/Citychoose/Citychoose"})},initSetting:function(e){var a=this;t.getStorage({key:"setting",success:function(t){var n=t.data||{};a.setting=n,e&&e(n)},fail:function(){a.setting={}}})},reloadInitSetting:function(){var t=this;this.initSetting((function(e){t.checkUpdate(e)}))},onShareAppMessage:function(t){var e=this.shareInfo;return{title:e.title||"天气查询",path:e.path||"/pages/Index/Index",imageUrl:e.imageUrl}},menuHide:function(){this.hasPopped&&(this.takeback(),this.hasPopped=!1)},menuMain:function(){this.hasPopped?(this.takeback(),this.hasPopped=!1):(this.popp(),this.hasPopped=!0)},menuToCitychoose:function(){this.menuMain(),t.navigateTo({url:"/pages/Citychoose/Citychoose"})},menuToSetting:function(){this.menuMain(),t.navigateTo({url:"/pages/Settings/Settings"})},popp:function(){var e=t.createAnimation({duration:200,timingFunction:"ease-out"}),a=t.createAnimation({duration:200,timingFunction:"ease-out"}),n=t.createAnimation({duration:200,timingFunction:"ease-out"}),i=t.createAnimation({duration:200,timingFunction:"ease-out"}),o=t.createAnimation({duration:200,timingFunction:"ease-out"});e.rotateZ(180).step(),a.translate(0,-60).rotateZ(360).opacity(1).step(),n.translate(-Math.sqrt(3200),-30).rotateZ(360).opacity(1).step(),i.translate(-Math.sqrt(3200),30).rotateZ(360).opacity(1).step(),o.translate(0,60).rotateZ(360).opacity(1).step(),this.animationMain=e.export(),this.animationOne=a.export(),this.animationTwo=n.export(),this.animationThree=i.export(),this.animationFour=o.export()},takeback:function(){var e=t.createAnimation({duration:200,timingFunction:"ease-out"}),a=t.createAnimation({duration:200,timingFunction:"ease-out"}),n=t.createAnimation({duration:200,timingFunction:"ease-out"}),i=t.createAnimation({duration:200,timingFunction:"ease-out"}),o=t.createAnimation({duration:200,timingFunction:"ease-out"});e.rotateZ(0).step(),a.translate(0,0).rotateZ(0).opacity(0).step(),n.translate(0,0).rotateZ(0).opacity(0).step(),i.translate(0,0).rotateZ(0).opacity(0).step(),o.translate(0,0).rotateZ(0).opacity(0).step(),this.animationMain=e.export(),this.animationOne=a.export(),this.animationTwo=n.export(),this.animationThree=i.export(),this.animationFour=o.export()}}};e.default=u}).call(this,a("543d")["default"])},e568:function(t,e,a){"use strict";var n=a("8673"),i=a.n(n);i.a}},[["6a65","common/runtime","common/vendor"]]]);